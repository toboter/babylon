<% title "Project: #{@project.name}", nil %>
<% edit_section_for(@project, @project.projectable) %>

<% content_for :breadcrumbs_section do %>
  <nav class="breadcrumbs">
    <% if @project.projectable_type == "Group" %>
      <%= link_to "Module: #{@project.projectable.area.cluster.name}", @project.projectable.area.cluster %>
      <%= link_to "Area: #{@project.projectable.area.name}", @project.projectable.area %>
      <%= link_to "Group: #{@project.projectable.name}", @project.projectable %>
    <% end %>
    <% if @project.projectable_type == "Cluster" %>
      <%= link_to "Module: #{@project.projectable.name}", @project.projectable %>
    <% end %>
    <%= link_to "Project: #{@project.name}", [@project.projectable, @project] %>
  </nav>
<% end %>

<% content_for :main_section do %>
  <div class="large-8 columns">
    <h5 class="subheader"><small>Belongs_to: </small><%= link_to "#{@project.projectable.name}", @project.projectable %></h5>

    <%= content_tag :h4, 'Documents', class: 'subheader' if @project.documents.any? %>

    <% if @project.documents.doctype('Introduction') %>
      <%= render "shared/document_first", var: @project, dtype: "Introduction" %>
    <% else %>
      <%= link_to "Add Introduction", polymorphic_path([:new, @project, :document], :document_type => "Introduction"), class: 'button small' if can? :edit, @project %>    
    <% end %>

    <%= render "shared/document_docs_without_type", :var => @project %>

    <%= render "shared/add_document_box", :add_doc => @project %>

    <% if can? :follow, @project %>
      <h4 class="subheader"><%= link_to "Todolists", project_todolists_path(@project) %></h5>
      <ul class="no-bullet">
        <% for todolist in @project.todolists do %>
          <li>
            <%= link_to "#{todolist.name}", [todolist.project, todolist] %>
            (Todo's: <%= todolist.todos.count %>, 
            Responsible: <%= todolist.responsible.available_name %>)
          </li>
        <% end %>
      </ul>
      <div class="row" style="margin-top:40px;margin-bottom:40px;">
        <div class="large-6 columns">
          <ul class="pricing-table">
            <li class="description">Hier ergänzender Text über die Möglichkeiten</li>
            <li class="cta-button"><%= link_to 'Add Todolist', new_project_todolist_path(@project), class: "button" %></li>
          </ul>
        </div>
      </div>
    <% end %>
  </div>

  <div class="large-3 columns right">
    <h5 class="subheader">Creator</h5>
    <ul class="no-bullet">
      <li>
        <% unless connected_profile(@project.creator) %>
          <%= @project.creator.available_name %>
        <% else %>
          <%= link_to "#{@project.creator.available_name}", @project.creator.people.first %>
        <% end %>
      </li>
    </ul>

    <h5 class="subheader">Members<small> <%= link_to " (add)", [:edit, @project.projectable, @project] if @project.memberships.where(:user_id => current_user, :role => 'admin').present? || (can? :manage, 'Memberships') %></small></h5>
    <% if @project.memberships.present? %>
      <ul class="no-bullet">
        <% for membership in @project.memberships do %>
          <li>
            <% if connected_profile(membership.user) %>
              <%= link_to "#{membership.user.available_name}", membership.user.people.first %>
            <% else %>
              <%= membership.user.available_name %>
            <% end %>
            <%= ' ('+membership.role+')' if can? :edit, @project %>
          </li>
        <% end %>
      </ul>
    <% end %>
  </div>

<% end %>

<% content_for :footer_section do %>


<% end %>