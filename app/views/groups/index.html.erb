<% title "Groups", nil, nil %>

<% content_for :breadcrumbs_section do %>
  <%= content_tag(:li, link_to("Root", root_path) + content_tag(:span, '/', class: 'divider')) %>
  <%= content_tag(:li, link_to("Modules", clusters_path) + content_tag(:span, '/', class: 'divider')) if @cluster %>
  <%= content_tag(:li, link_to(@cluster.name, @cluster) + content_tag(:span, '/', class: 'divider')) if @cluster %>
  <%= content_tag :li, "Groups", class: 'active' %>
<% end %>

<% content_for :main_section do %>
<div class="row-fluid">
  <%= content_tag :div, class: "span12" do %>
    <h1>
      <% if @cluster %>
        Groups in "<%= link_to @cluster.name, @cluster %>"
      <% else %>
        All groups
      <% end %>
    </h1>
  <% end %>
</div>
<div class="row-fluid">
  <div class="span3">
    <%= content_tag :div, class: "documents-options" do %>
      <ul class="nav nav-pills nav-stacked">
        <%= content_tag :li, class: "#{'active' unless params[:mode]}" do %>
          <%= link_to polymorphic_url([@cluster, :groups]) do %>
            All Groups
            <span class="cnt pull-right"><%= @groups.count %></span>
          <% end %>
        <% end %>
        <!-- <%= content_tag :li, class: "#{'active' if params[:mode]=='you-are-in'}" do %>
          <%= link_to polymorphic_url([@cluster, :groups], mode: 'you-are-in'), class: '' do %>
            You are in
            <span class="cnt pull-right"><%= @groups.count %></span>
          <% end %>
        <% end %> -->
      </ul>
    <% end %>
  </div>

  <div class="span9">
    <%= content_tag :div, class: "groups-options row-fluid" do %>

        <%= link_to [:new, @cluster, :group], class: "btn btn-default pull-right" do %>
          <i class="icon-plus"></i>
          Group
        <% end if @cluster %>

    <% end if @cluster && (can? :create, :group) %>

    <div class="groups-list row-fluid">
      <% if @groups.any? %>
        <%= render @groups %>
      <% else %>
        <div class="" style="background-color:#f5f5f5; height:80px; padding-top:40px;margin-top:0px;">
          <p class="text-center">No groups to show. <%= link_to 'Create a new group.', polymorphic_path([:new, @cluster, :group]) if @cluster %></p>
        </div>
      <% end %>
    </div>
  </div>
</div>
<% end %>