<% title "Bibliography", nil unless @parent %>
<% title "References for ", @parent.name if @parent %>

<% content_for :breadcrumbs_section do %>
  <li><%= link_to 'Root', root_path %> <span class="divider">/</span></li>
  <% if @parent.class.name == 'Project' %>
    <li>... <%= content_tag(:span, '/', class: 'divider') %></li>
    <%= content_tag(:li, link_to("Projects", [@parent.projectable, 'projects']) + content_tag(:span, '/', class: 'divider')) %>
    <%= content_tag(:li, link_to("#{@parent.name}", [@parent.projectable, @parent]) + content_tag(:span, '/', class: 'divider')) %>
  <% end %>
  <li class="active"><%= @parent ? 'References' : 'Bibliography' %></li>
<% end %>

<% content_for :main_section do %>
  <div class="span12">
    <ul class="nav nav-pills">
      <%= content_tag :li, link_to("Bibliography", references_path), class: 'active' unless @parent %>
      <%= content_tag :li, link_to("Books", books_path) unless @parent %>
      <%= content_tag :li, link_to("Journals and serials", serials_path) unless @parent %>

      <%= content_tag :div, class: "btn-group" do %>
        <%= link_to 'show all', references_path(show: 'all'), class: "btn btn-small #{'active' if params[:show]=='all'}" %>
        <%= link_to 'show main bibliography', references_path, class: "btn btn-small #{'active' if params[:show]!='all'}" %>
      <% end unless @parent %>

      <%= link_to new_reference_path, class: 'btn btn-create pull-right', style: 'margin-left:10px;' do %>
        <i class="icon-plus icon-white"></i>
        Reference
      <% end if aspect? && (can? :create, @references) %>
      <%= form_tag ('/reference'), method: :get, class: 'form-inline pull-right' do %>
        <div class="input-append">
          <%= select_tag :per_page, options_for_select([5, 10, 20, 30, 50, 100], params[:per_page] ? params[:per_page] : 10), id: 'appendInputButton', class: 'span1' %>
          <%= submit_tag "per Page", class: 'btn' %>
        </div>
      <% end %>
    </ul>
    <div class="row-fluid">
      <div class="span3">
        <p class="text text-info">Showing <%= @references.count %><%= content_tag :span, raw(' of ' + (link_to @references_all.count, references_path)) if @references_all %> entries</p>
      </div>
      <div class="span9">
        <% if @indirect_references || @direct_references %>
          <%= content_tag :h4, 'References used in the project' if @indirect_references %>
          <div style="color:#bbb;">
            <%= render "bib_entries", :references => @indirect_references %>
          </div>
          <%= content_tag :h4, 'References added to the project' if @direct_references %>
          <%= render "bib_entries", :references => @direct_references %>
        <% else %>
          <%= render "bib_entries", :references => @references %>        
          <%= will_paginate(@references, class: 'pagination pagination-centered', :renderer => WillPaginate::ActionView::BootstrapLinkRenderer) %>
        <% end %>
        <%= content_tag :p, class: 'pull-right' do %>
          Download:
          <%= link_to "CSV", references_path(format: "csv"), class: 'btn btn-mini disabled', id: 'csv-link' %>
          <%= link_to "Excel", references_path(format: "xls"), class: 'btn btn-mini', id: 'excel-link' %>
        <% end if can? :read, @references %>
      </div>
    </div>
    <div class="row-fluid" style="margin-top:100px;">
      <div class="span12">
        <div class="well">
          <h4>GLOSSARY</h4>
          <ul class="unstyled">
            <li>Monographs / Monographien — <em>Book with an explicit author</em></li>
            <li>In Books / Buchbeitrag — <em>An untitled part, section or chapter of a monograph</em></li>
            <li>Collections / Sammelband — <em>A collection of texts contributed by different authors</em></li>
            <li>In Collections / Sammelbandbeitrag — <em>Part of a superior work with its own title</em></li>
            <li>Proceedings / Konferenzband/Tagungsband — <em>A collection of contributions published in the context of a conference or workshop</em></li>
            <li>In Proceedings / Konferenzbeitrag — <em>Contribution in a conference proceedings</em></li>
            <li>Journal / Zeitschrift — <em>A periodical published at regular intervals</em></li>
            <li>Issue / Ausgabe — <em>Issue of a journal</em></li>
            <li>In Journal / Zeitschriftenartikel — <em>Article in a journal</em></li>
            <li>Reference / Nachschlagewerk — <em>References including encyclopedia, dictionaries, compendia, bibliographies and online-references</em></li>
            <li>In Reference / Lexikonartikel — <em>Contribution in a reference</em></li>
          </ul>
        </div>
      </div>
    </div>
  </div>

<% end %>