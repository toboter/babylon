<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html class="ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]>    <html class="ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]>    <html class="ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en"> <!--<![endif]-->
  <head>
  	<meta charset="utf-8" />

  	<!-- Uncomment to make IE8 render like IE7 -->
  	<!-- <meta http-equiv="X-UA-Compatible" content="IE=7" /> -->

  	<!-- Set the viewport width to device width for mobile -->
  	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

  	<title>BABylo-tec: <%= content_for?(:title) ? yield(:title) : "Untitled" %></title>

  	<%= stylesheet_link_tag    "application" %>
  	<%= javascript_include_tag "vendor/custom.modernizr" %>
    <%= csrf_meta_tags %>
  </head>

  <body>
  	<nav class="top-bar">
      <ul class="title-area">
        <li class="name">
          <h1><%= link_to "BABylo-tec", root_path %></h1>
        </li>
        <li class="toggle-topbar menu-icon">
          <a href="#">
            <span></span>
          </a>
        </li>
      </ul>
      <section class="top-bar-section">
        <ul class="left">
          <li class="divider"></li>
          <li class="has-dropdown"><%= link_to "Explore", root_path %>
            <ul class="dropdown">
              <li><%= link_to "People", people_path %></li>
              <li class="has-dropdown"><%= link_to "Bibliography", references_path %>
                <ul class="dropdown">
                  <li><label>Bibliography</label></li>
                  <li><%= link_to "Articles and Monographs", references_path %></li>
                  <li><%= link_to "Books", books_path %></li>
                  <li><%= link_to "Periodicals and Series", serials_path %></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="divider"></li>
          <li><%= link_to "Search" %></li>
          <li class="divider"></li>
        </ul>
        <ul class="right">
          <% if user_signed_in? %>
            <li><%= link_to "Dashboard", dashboard_path %></li>
            <li class="divider"></li>
            <% if connected_profile %>
              <li><%= link_to "#{current_user.available_name}", person_path(connected_profile) %></li>
            <% else %>
              <li><%= link_to "#{current_user.available_name}" %></li>
            <% end %>
            <li class="divider"></li>



            <li class="has-dropdown"><%= link_to(dashboard_path) do %><i class="foundicon-settings"></i><% end %>
              <ul class="dropdown">
                
                <% if can? :manage, 'settings' %>
                  <li class="has-dropdown"><%= link_to "Application Settings" %>
                    <ul class="dropdown">
                      <li><%= link_to "Active accounts" %></li>
                      <li><%= link_to "Projects" %></li>
                      <li><%= link_to "Institutions" %></li>
                      <li><%= link_to "Predicates" %></li>
                      <li><%= link_to "About us section" %></li>
                    </ul>
                  </li>
                <% end %>
                <% unless connected_profile %>
                  <li><%= link_to 'Account Settings', edit_user_registration_path %></li>
                <% end %>
                <% if connected_profile %>
                  <li><%= link_to 'Account Settings', edit_user_registration_path %></li>
                <% else %>
                  <li>
                    <a href="#" data-reveal-id="connect_profile">Connect profile</a>
                  </li>
                <% end %>
                <li><%= link_to "Log Out", destroy_user_session_path, method: :delete %></li>              
                <li class="divider"></li>
                <li><%= link_to "Help" %></li>
              </ul>
            </li>
          <% else %>
  			    <li><%= link_to "Sign up", new_user_registration_path %></li>
  			    <li class="divider"></li>
  			    <li><%= link_to "Login", new_user_session_path %></li>
		      <% end %>
        </ul>
      </section>
    </nav>

    <div class="container">
  	  <div class="row">
        <div class="large-12 columns">
  	  	  <% flash.each do |name, msg| %>
            <%= content_tag :div, msg, :id => "flash_#{name}", :class => "alert-box radius" %>
          <% end %>
        <%= content_for?(:content) ? yield(:content) : yield %>
        
        </div>
      </div>      
    </div>

    <div class="row" style="margin-top:100px;">
      <div class="large-3 columns">
        <ul class="side-nav">
          <li><%= link_to "Items" %></li>
        </ul>
      </div>
    
      <div class="large-3 columns">
        <ul class="side-nav">
          <li><%= link_to "Articles and Monographs", references_path %></li>
          <li><%= link_to "Books", books_path %></li>
          <li><%= link_to "Periodicals and Series", serials_path %></li>
        </ul>
      </div>
      
      <div class="large-3 columns">
        <ul class="side-nav">
          <li><%= link_to "People", people_path %></li>
        </ul>
      </div>
    
      <div class="large-3 columns">
        <ul class="side-nav">
          <li><%= link_to "About" %></li>
          <li><%= link_to "Search" %></li>
        </ul>
      </div>
    </div>

    <div class="row" style="margin-top:200px;">
      <div class="large-12 columns">
          <p><%= params %></p>
          <p><%= session.inspect if session %></p>
          <p></p>
      </div>
    </div>


  <% if user_signed_in? %>
    <% unless connected_profile %>
      <div id="connect_profile" class="reveal-modal">
        <a class="close-reveal-modal">&#215;</a>
        <div class="row">
          <div class="large-8 columns">
            <h3>Connect your account to a profile</h3>
            <%= form_tag user_connect_path, :class => "custom" do %>
              <div class="row collapse">
                <div class="small-8 columns">
                  <%= select_tag :person_id, options_from_collection_for_select(Person.unconnected, "id", "fullname"), :prompt => 'Choose a person', class: "large-8" %>
                  <%= hidden_field_tag :connect_user_id, current_user.id %>
                </div>
                <div class="small-4 columns">
                  <%= submit_tag "Connect", class: "button prefix" %>
                </div>
              </div>
            <% end %>
            <span>Not on the list? <%= link_to "New profile", new_person_path(:user_id => current_user) %></span>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>

    
    <%= javascript_include_tag "application" %>
  </body>
</html>
