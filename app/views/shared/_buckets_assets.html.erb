<% if obj.buckets.present? %>
  <% for bucket in obj.buckets do %>
    <p class="pull-right">
      <% if can? :edit, obj %>
        <% if personal == true %>
          <% if (!obj.user_id?) || (obj.user_id == current_user.id) %>
            <%= link_to "Show", polymorphic_path([obj, bucket]) %> | 
            <%= link_to "Add assets to #{bucket.name}", new_bucket_asset_path(bucket) %>
          <% end %>
        <% else %>
          <%= link_to "Show", polymorphic_path([obj, bucket]) %> | 
          <%= link_to "Add assets to #{bucket.name}", new_bucket_asset_path(bucket) %>
        <% end %>
      <% end %>
    </p>
    <h4 class="muted"><%= link_to "#{bucket.name}", [bucket.attachable, bucket] %></h4>
    <ul class="thumbnails">
      <% if bucket.cover %>
        <li class="span4">
          <%= link_to (image_tag bucket.cover.assetfile.big_thumb.url, class: "img-polaroid"), bucket.cover %>
        </li>
      <% end %>
      <% for asset in bucket.assets.where('content_type LIKE ?', 'image%').limit(bucket.cover ? 4 : 8).order('created_at desc') do %>
        <li class="span2 bucket-asset-thumbs">
          <%= link_to (image_tag asset.assetfile.thumb.url, class: "img-polaroid"), asset %>
        </li>
      <% end %>
    </ul>
    <ul>
      <% for asset in bucket.assets.where('content_type NOT LIKE ?', 'image%').limit(6).order('created_at desc') do %>
        <li><%= link_to "#{asset.name}", asset %></li>
      <% end %>
    </ul>
  <% end %>
<% end %>